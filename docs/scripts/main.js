function showCurrentPosition(e){longitude=e.coords.longitude,latitude=e.coords.latitude,getWeather(longitude,latitude)}function showError(e){$("#loadingCircle").hide(),openSearchBar()}function getWeather(e,a,t){$.ajax({url:"https://api.forecast.io/forecast/e550740d61115b913ad25f86b68f73be/"+a+","+e+"?units=si",type:"GET",dataType:"jsonp"}).done(function(e){weatherData=e,hero.set("temp",Math.round(e.currently.temperature)),hero.set("icon",e.currently.icon),hero.set("location",t||"Current location"),hero.set("summary",e.currently.summary),hero.set("summary2",e.daily.summary),day1.set("temp",e.daily.data[1].temperatureMax),day1.set("icon",e.daily.data[1].icon),day2.set("temp",e.daily.data[2].temperatureMax),day2.set("icon",e.daily.data[2].icon),$(".weather-app").show(),$("#loadingCircle").hide()}).fail(function(){console.log("error")}).always(function(){})}function getLocation(e){$.ajax({url:"https://maps.googleapis.com/maps/api/geocode/json?address="+e+"&key=AIzaSyCACgmBbuERO1cuPFn4GfkzsvtPNKPwe10",type:"GET",dataType:"json",jsonpCallback:"result"}).done(function(e){if("ZERO_RESULTS"!=e.status){var a=e.results[0].geometry.location.lng,t=e.results[0].geometry.location.lat;getWeather(a,t,e.results[0].formatted_address)}else $("#loadingCircle").hide(),$(".error-message").html("Sorry, It seem we can't find the location of your input.")}).fail(function(){console.log("error")}).always(function(){})}function initNewLocation(){$(".error-message").html(""),$(".weather-app").fadeOut(),$("#loadingCircle").show();var e=$(".search-bar_input").val();getLocation(e)}function toggleSearchBar(){$(".search-bar").slideToggle(),$(".nav .icon-search").toggle(),$(".nav .icon-close").toggle(),$(".search-bar_input").focus()}function openSearchBar(){$(".search-bar").slideDown(),$(".nav .icon-search").hide(),$(".nav .icon-close").show(),$(".search-bar_input").focus()}var app=app||{};app.weather=Backbone.Model.extend({defaults:{day:"unknown",temp:"No info",icon:"rain"}});var app=app||{};app.weatherView=Backbone.View.extend({tagName:"div",className:"container--half weather-days",template:_.template($("#weatherDaysElement").html()),render:function(){var e=this.template(this.model.toJSON());return this.$el.html(e),this},initialize:function(){this.model.on("change",this.render,this)}});var app=app||{};app.weatherAllView=Backbone.View.extend({tagName:"section",className:"next-days--inner",render:function(){return this.collection.each(this.addWeather,this),this},addWeather:function(e){var a=new app.weatherView({model:e});this.$el.append(a.render().el)}});var app=app||{};app.weatherCollection=Backbone.Collection.extend({model:app.weather});var weatherHero=Backbone.Model.extend({defaults:{temp:"No info",icon:"placeholder",location:"",summary:""}}),weatherHeroView=Backbone.View.extend({tagName:"div",className:"hero--inner",template:_.template($("#weatherHeroElement").html()),render:function(){this.$el.html(this.template(this.model.toJSON()))},initialize:function(){this.render(),this.model.on("change",this.render,this)}}),weatherData,longitude,latitude;$(".weather-app").hide(),$(".search-bar").hide(),$(".nav .icon-close").hide(),function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(showCurrentPosition,showError)}();var weekday;!function(){var e=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],a=new Date;weekday=e[a.getDay()+2]}();var hero=new weatherHero({temp:0,icon:"",location:"",summary:""}),day1=new app.weather({day:"Tomorrow",temp:0,icon:"placeholder"}),day2=new app.weather({day:weekday,temp:0,icon:"placeholder"}),weatherGroup=new app.weatherCollection([day1,day2]),weatherGroupView=new app.weatherAllView({collection:weatherGroup});$("#nextDays").html(weatherGroupView.render().el);var hero=new weatherHero({temp:0,icon:"placeholder",location:"Current location",summary:"",summary2:""}),weatherHeroView=new weatherHeroView({model:hero});weatherHero.el,$("#hero").html(weatherHeroView.el),$("#find").click(initNewLocation),$(".nav-search").click(toggleSearchBar),$(".search-bar_input").keyup(function(e){13==e.keyCode&&initNewLocation()});